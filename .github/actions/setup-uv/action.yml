name: "Setup Python + uv (cached)"
description: "Sets up Python 3.12 and uv with sensible caching for GitHub CI and act"

runs:
  using: "composite"
  steps:
    - name: Setup Python 3.12 (composite)
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"
    # Install uv locally under act
    - name: Install uv (act workaround)
      if: ${{ github.actor == 'nektos/act' }}
      uses: astral-sh/setup-uv@v5
      with:
        cache-local-path: "/uv-cache"
        prune-cache: false
    # Normal uv install path on real GitHub runners
    - name: Install uv
      if: ${{ github.actor != 'nektos/act' }}
      uses: astral-sh/setup-uv@v6
      with:
        enable-cache: true
        cache-dependency-glob: |
          uv.lock
          pyproject.toml
        cache-local-path: "${{ github.workspace }}/.uv-cache"
